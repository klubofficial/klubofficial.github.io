"use strict";(self.webpackChunkklub=self.webpackChunkklub||[]).push([[9572],{42460:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(73542),r=n(64554),s=n(20890),i=n(36151),l=n(80184);const o=e=>{let{open:t,handleClose:n,handleSubmit:o,confirmMessage:u="\uc815\ub9d0 \uc2e4\ud589\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"}=e;return(0,l.jsx)(a.Z,{open:t,onClose:n,children:(0,l.jsxs)(r.Z,{textAlign:"center",p:3,children:[(0,l.jsx)(s.Z,{variant:"h4",color:"primary",children:u}),(0,l.jsxs)(r.Z,{display:"flex",justifyContent:"space-evenly",mt:2,children:[(0,l.jsx)(i.Z,{variant:"outlined",onClick:n,children:"\ucde8\uc18c"}),(0,l.jsx)(i.Z,{variant:"contained",color:"error",onClick:o,children:"\ud655\uc778"})]})]})})}},89572:(e,t,n)=>{n.r(t),n.d(t,{default:()=>W});var a=n(28683),r=n(98246),s=n(72791),i=n(38025),l=n(6907),o=n(16871),u=n(95193),c=n(10703),d=n(20890),h=n(64554),v=n(36151),p=n(61889),m=n(13967),b=n(66934),x=n(86856),g=n(4385),Z=n(42460),f=n(68096),k=n(94925),y=n(58406),I=n(79834),j=n(23786),C=n(94721),S=n(88970),N=n(85523),E=n(61419),R=n(79012),A=n(94454),w=n(71747),O=n(27391),D=n(17604),z=n(80184);const q=e=>{var t;let{applyInfo:n,isRecruitingPeriod:a,questions:r,handleChange:s,handleTextAnswerChange:l,handlePhoneNumberChange:o,handleCheckBoxAnswerChange:u}=e;const c=(0,i.fC)(),v=(0,m.Z)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(P,{id:"email",type:"email",label:"\uc774\uba54\uc77c",disabled:!0,value:n.email,inputProps:{readOnly:!0}}),(0,z.jsx)(P,{id:"student-id",type:"text",label:"\ud559\ubc88",disabled:!0,value:n.studentId,inputProps:{readOnly:!0}}),(0,z.jsx)(P,{id:"name",name:"name",type:"text",label:"\uc774\ub984",inputProps:{maxLength:50},value:n.name,onChange:s}),(0,z.jsx)(P,{id:"phone-number",name:"phoneNumber",type:"tel",label:"\uc804\ud654\ubc88\ud638",inputProps:{pattern:"010-[0-9]{4}-[0-9]{4}",maxLength:13},helperText:x.Nh.PHONE_NUMBER,value:n.phoneNumber,onChange:o}),(0,z.jsxs)(f.Z,{sx:{margin:1,width:"100%"},size:"small",required:!0,children:[(0,z.jsx)(k.Z,{htmlFor:"department",children:"\ud559\uacfc/\ud559\ubd80"}),(0,z.jsx)(y.Z,{id:"department",name:"department",label:"\ud559\uacfc/\ud559\ubd80",value:n.department,onChange:s,fullWidth:!0,children:D.Z&&Object.keys(D.Z).map((e=>[(0,z.jsx)(I.Z,{sx:{fontWeight:"bold"},children:e}),D.Z[e]&&D.Z[e].map((t=>[(0,z.jsx)(j.Z,{value:e===t?t:e+" "+t,children:t})]))]))})]}),!(null!==(t=c())&&void 0!==t&&t.phoneNumber)&&(0,z.jsx)(h.Z,{children:(0,z.jsx)(d.Z,{variant:"body1",display:"inline",children:"\uc785\ub825\ud558\uc2e0 \uc815\ubcf4\ub294 \ub3d9\uc544\ub9ac \uad00\ub9ac\ub97c \uc704\ud574 \uc11c\ubc84\uc5d0 \uc800\uc7a5\ub429\ub2c8\ub2e4."})}),(0,z.jsx)(C.Z,{}),r&&0!==r.length&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(d.Z,{variant:"h4",sx:{marginTop:1,mb:4},children:"\uc9c0\uc6d0\uc11c \uc9c8\ubb38"}),r.map(((e,t)=>{var r,s,i,o;return(0,z.jsxs)(h.Z,{width:"100%",sx:{marginBottom:1},children:[(0,z.jsxs)(h.Z,{"aria-label":"question title",display:"flex",alignItems:"baseline",children:[(0,z.jsx)(d.Z,{variant:"h6",sx:{marginBottom:v.spacing(.5),textAlign:"left"},children:e.contents}),e.isEssential&&(0,z.jsx)(d.Z,{variant:"caption",children:"\xa0*\ud544\uc218\ud56d\ubaa9\uc785\ub2c8\ub2e4"})]}),e.isCheckBox&&e.isMultiSelectable&&(0,z.jsx)(d.Z,{variant:"caption",children:"\xa0\ub2e4\uc911\uc120\ud0dd\uc774 \uac00\ub2a5\ud569\ub2c8\ub2e4"}),e.isCheckBox&&!e.isMultiSelectable?(0,z.jsx)(h.Z,{style:_,children:(0,z.jsx)(f.Z,{required:e.isEssential,children:(0,z.jsx)(S.Z,{name:"".concat(t),onChange:e=>u(t,Number(e.target.value),!1),children:null===(r=e.options)||void 0===r?void 0:r.map(((e,n)=>(0,z.jsx)(N.Z,{name:"".concat(t),value:n,control:(0,z.jsx)(E.Z,{size:"small"}),label:e,disabled:!a},n)))})})}):e.isCheckBox?(0,z.jsx)(h.Z,{style:_,children:(0,z.jsx)(f.Z,{children:(0,z.jsx)(R.Z,{children:null===(s=e.options)||void 0===s?void 0:s.map(((e,n)=>(0,z.jsx)(N.Z,{name:"".concat(t),value:e,onChange:e=>u(t,n,!0),control:(0,z.jsx)(A.Z,{size:"small"}),label:e,disabled:!a},n)))})})}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(w.Z,{style:_,required:e.isEssential,minRows:4,maxRows:6,name:"".concat(t),disabled:!a,maxLength:1e3,onChange:l}),n.answers&&(0,z.jsxs)(d.Z,{variant:"subtitle1",textAlign:"right",children:[null===(i=n.answers[t])||void 0===i||null===(o=i.text)||void 0===o?void 0:o.length," / ",1e3]})]})]},t)}))]})]})},_={padding:8,width:"100%",borderRadius:5,border:"1px solid lightgrey",fontFamily:"Pretendard"},P=e=>(0,z.jsx)(O.Z,(0,a.Z)({size:"small",required:!0,fullWidth:!0},e));var U=n(12718),L=n(74529),Q=n(58246);const F=new Date,W=()=>{var e,t,n,b,f,k;const y=(0,m.Z)(),I=(0,u.Z)(y.breakpoints.up("sm")),{enqueueSnackbar:j}=(0,r.Ds)(),{id:C,recruitId:S}=(0,o.UO)(),N=Number(C),E=Number(S),R=(0,o.s0)(),A=(0,i.fC)(),{data:w,isSuccess:O,isLoading:D}=(0,Q.ID)(N,E),{data:_,isSuccess:P}=(0,L.b)(N,E),[W,T]=(0,s.useState)({name:null===(e=A())||void 0===e?void 0:e.name,phoneNumber:null===(t=A())||void 0===t?void 0:t.phoneNumber,department:null===(n=A())||void 0===n?void 0:n.department,studentId:null===(b=A())||void 0===b?void 0:b.studentId,email:null===(f=A())||void 0===f?void 0:f.email,answers:null});(0,s.useEffect)((()=>{T((0,a.Z)((0,a.Z)({},W),{},{answers:_?_.map((e=>({questionId:e.id,text:null,optionIndices:null}))):null}))}),[P]);const[K,B]=(0,s.useState)(!1),G=(0,U.Ne)(),V=O&&w.startAt<=F.toISOString()&&(!w.endAt||F.toISOString()<=w.endAt),H=parseInt(null===(k=A())||void 0===k?void 0:k.studentId.slice(2,4)),Y=O&&(!w.allowedCollege||!W.department||w.allowedCollege===W.department.split(" ")[0])&&(!w.maxGrade||parseInt(w.maxGrade)<=H)&&(!w.minGrade||parseInt(w.minGrade)>=H);(0,s.useEffect)((()=>{var e;const t=(null===(e=A())||void 0===e?void 0:e.clubs.filter((e=>e.id===N)).length)>0;!D&&t&&(j("\uc774\ubbf8 \uac00\uc785\ub41c \ub3d9\uc544\ub9ac\uc785\ub2c8\ub2e4.",{variant:"error"}),setTimeout((()=>{R(-1)}),1e3)),D||O||setTimeout((()=>{R(-1)}),1e3)}),[D,O]);return(0,s.useEffect)((()=>{if(O&&w.endAt){const e=new Date(w.endAt);e.setDate(e.getDate()+1),F<=e||(j("\uc9c0\uae08\uc740 \uc9c0\uc6d0 \uae30\uac04\uc774 \uc544\ub2d9\ub2c8\ub2e4.",{variant:"error"}),R(-1))}}),[O]),(0,z.jsxs)(M,{children:[(0,z.jsx)(l.ql,{children:(0,z.jsx)("title",{children:"\ub3d9\uc544\ub9ac \uc9c0\uc6d0"})}),(0,z.jsxs)(c.Z,{square:!I,sx:{my:y.spacing(8),padding:3,flex:1,maxWidth:"480px",[y.breakpoints.down("sm")]:{my:0,py:5,maxWidth:"100%"}},children:[(0,z.jsx)(d.Z,{component:"h1",variant:"h3",sx:{mb:2,textAlign:"center"},children:"\ub3d9\uc544\ub9ac \uc9c0\uc6d0\uc11c"}),(0,z.jsxs)(h.Z,{component:"form",sx:{display:"flex",flexDirection:"column",alignItems:"center","& .MuiTextField-root":{margin:1}},onSubmit:e=>{e.preventDefault(),O&&B(!0)},children:[(0,z.jsx)(q,{applyInfo:W,questions:null!==_&&void 0!==_?_:[],isRecruitingPeriod:V,handleChange:e=>{const{name:t,value:n}=e.target;if(T((e=>(0,a.Z)((0,a.Z)({},e),{},{[t]:n}))),e.target instanceof HTMLInputElement&&"name"===e.target.name){const t=e.target,n=t.value.trim(),a=/^[a-zA-Z0-9\u3131-\u314e\u314f-\u3163\uac00-\ud7a3 ]*$/.test(t.value);if(n!==t.value)return void t.setCustomValidity("\uc774\ub984 \uc55e\ub4a4\uc5d0 \uacf5\ubc31\ubb38\uc790\ub97c \ud3ec\ud568\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");if(!a)return void t.setCustomValidity("\uc774\ub984\uc5d0 \ud2b9\uc218\ubb38\uc790\ub97c \ud3ec\ud568\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");t.setCustomValidity("")}},handleTextAnswerChange:e=>{let{target:{name:t,value:n}}=e;W.answers&&T((0,a.Z)((0,a.Z)({},W),{},{answers:(0,a.Z)((0,a.Z)({},W.answers),{},{[t]:(0,a.Z)((0,a.Z)({},W.answers[Number(t)]),{},{text:n})})}))},handlePhoneNumberChange:e=>{let{target:{value:t}}=e;T((e=>(0,a.Z)((0,a.Z)({},e),{},{phoneNumber:(0,g.j)(t)})))},handleCheckBoxAnswerChange:(e,t,n)=>{var r;if(!_)return;const s=W.answers?W.answers:_.map((e=>({questionId:e.id,text:null,optionIndices:null}))),i=s[e],l=null!==(r=null===i||void 0===i?void 0:i.optionIndices)&&void 0!==r?r:[],o=l.indexOf(t),u=n?o>-1?l.splice(o,1):[...l,t]:[t];s[e]=(0,a.Z)((0,a.Z)({},i),{},{optionIndices:u}),T((0,a.Z)((0,a.Z)({},W),{},{answers:(0,a.Z)({},s)}))}}),(0,z.jsx)(v.Z,{type:"submit",variant:"contained",fullWidth:!0,sx:{"&.Mui-disabled":{backgroundColor:y.palette.divider}},disabled:!V||!Y,children:"\uc9c0\uc6d0\uc11c \uc81c\ucd9c"}),(0,z.jsx)(p.ZP,{container:!0,pl:2,justifyContent:"center",mt:1,children:(0,z.jsx)(d.Z,{variant:"body1",display:"inline",color:"error",children:Y?!V&&"* \ub2f5\ubcc0 \uc791\uc131 \ubc0f \uc81c\ucd9c\uc740 \ubaa8\uc9d1 \uc2dc\uc791 \uc774\ud6c4\uc5d0 \ud65c\uc131\ud654\ub429\ub2c8\ub2e4.":"* \ubaa8\uc9d1 \uc81c\ud55c \uc790\uaca9\uc774 \ucda9\uc871\ub418\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4"})})]})]}),(0,z.jsx)(Z.Z,{open:K,handleClose:()=>B(!1),handleSubmit:()=>{if(O){const e=Object.assign({},W);e.answers&&(e.answers=Object.values(e.answers)),G.mutate({clubId:N,recruitId:w.id,data:e})}},confirmMessage:x.A9.APPLY_CONFIRM})]})},M=(0,b.ZP)(h.Z)((()=>"\n        display: flex;\n        justify-content: center;\n        align-items: center;\n    "))},12718:(e,t,n)=>{n.d(t,{Ne:()=>c,bL:()=>d});var a=n(31243),r=n(7477),s=n(98246),i=n(38025),l=n(91933),o=n(16871),u=n(86856);const c=()=>{const{enqueueSnackbar:e}=(0,s.Ds)(),t=(0,i.cl)()(),n=(0,o.s0)();return(0,l.useMutation)("putForm",(e=>(async(e,t)=>{let{clubId:n,data:r,recruitId:s}=e;await a.default.post("".concat("https://dev.api.klub.kr","/club/").concat(n,"/recruit/").concat(s,"/application"),r,{headers:{Authorization:t}})})(e,t)),{onSuccess:()=>{e(u.KD.APPLY_SUCCESS,{variant:"success"}),n(-1)},onError:t=>{var n,a,s;t instanceof r.d7?e(null!==(n=null===(a=t.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)&&void 0!==n?n:u.P6.EDIT_FAIL,{variant:"error"}):e(u.uz.UNKNOWN_ERROR,{variant:"error"})}})},d=(e,t)=>{const{enqueueSnackbar:n}=(0,s.Ds)(),o=(0,i.cl)()();return(0,l.useQuery)(["application",e,t],((e,t,n)=>async()=>(await a.default.get("".concat("https://dev.api.klub.kr","/club/").concat(e,"/recruit/").concat(n,"/application"),{headers:{Authorization:t}})).data)(e,o,t),{enabled:!!t&&!!o,onError:e=>{e instanceof r.d7||n(u.uz.UNKNOWN_ERROR,{variant:"error"})}})}},74529:(e,t,n)=>{n.d(t,{C:()=>u,b:()=>c});var a=n(31243),r=n(7477),s=n(98246),i=n(38025),l=n(91933),o=n(86856);const u=()=>{const{enqueueSnackbar:e}=(0,s.Ds)(),t=(0,i.cl)()(),n=(0,l.useQueryClient)();return(0,l.useMutation)("postQuestion",(e=>(async(e,t)=>{let{clubId:n,recruitId:r,questions:s}=e;await a.default.put("".concat("https://dev.api.klub.kr","/club/").concat(n,"/recruit/").concat(r,"/question"),s,{headers:{Authorization:t}})})(e,t)),{onSuccess:()=>{e(o.P6.ADD_QUESTION_SUCCESS,{variant:"success"}),n.invalidateQueries("questions")},onError:t=>{t instanceof r.d7?e(o.P6.ADD_QUESTION_FAIL,{variant:"error"}):e(o.uz.UNKNOWN_ERROR,{variant:"error"})}})},c=(e,t)=>{const{enqueueSnackbar:n}=(0,s.Ds)(),u=(0,i.cl)()();return(0,l.useQuery)(["questions"],(e=>{let{clubId:t,token:n,recruitId:r}=e;return async()=>(await a.default.get("".concat("https://dev.api.klub.kr","/club/").concat(t,"/recruit/").concat(r,"/question"),{headers:{Authorization:n}})).data})({clubId:e,recruitId:t,token:u}),{onError:e=>{var t,a;e instanceof r.d7?n((null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||o.uz.LOAD_FAIL,{variant:"error"}):n(o.uz.UNKNOWN_ERROR,{variant:"error"})},retry:0})}},58246:(e,t,n)=>{n.d(t,{ID:()=>c,Id:()=>h,JA:()=>b,KU:()=>v,aj:()=>p,m8:()=>d,tQ:()=>m});var a=n(31243),r=n(7477),s=n(98246),i=n(38025),l=n(91933),o=n(16871),u=n(86856);const c=(e,t)=>{const{enqueueSnackbar:n}=(0,s.Ds)(),o=(0,i.cl)()();return(0,l.useQuery)(["recruits"],(e=>{let{clubId:t,recruitId:n,token:r}=e;return async()=>{const e=n?"".concat("https://dev.api.klub.kr","/club/").concat(t,"/recruit/").concat(n):"".concat("https://dev.api.klub.kr","/club/").concat(t,"/recruit");return(await a.default.get(e,{headers:{Authorization:r}})).data}})({clubId:e,recruitId:t,token:o}),{onError:e=>{e instanceof r.d7||n(u.uz.UNKNOWN_ERROR,{variant:"error"})},retry:0})},d=()=>{const{enqueueSnackbar:e}=(0,s.Ds)(),t=(0,i.cl)()(),n=(0,l.useQueryClient)();return(0,l.useMutation)("putRecruit",(e=>(async(e,t)=>{let{clubId:n,data:r,recruitId:s}=e;await a.default.put("".concat("https://dev.api.klub.kr","/club/").concat(n,"/recruit/").concat(s),r,{headers:{Authorization:t}})})(e,t)),{onSuccess:()=>{e(u.uz.UPDATE_SUCCESS,{variant:"success"}),n.invalidateQueries("recruits")},onError:t=>{if(t instanceof r.d7){var n,a;const r=(null===(n=t.response)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.message)||u.uz.ADD_FAIL;e(r,{variant:"error"})}else e(u.uz.UNKNOWN_ERROR,{variant:"error"})}})},h=()=>{const{enqueueSnackbar:e}=(0,s.Ds)(),t=(0,i.cl)()(),n=(0,l.useQueryClient)();return(0,l.useMutation)("postRecruit",(async e=>{const n=await(async(e,t)=>{let{clubId:n,data:r,date:s}=e;return(await a.default.post("".concat("https://dev.api.klub.kr","/club/").concat(n,"/recruit?semester=").concat(s.semester,"&year=").concat(s.year),r,{headers:{Authorization:t}})).data.recruitId})(e,t);return n}),{onSuccess:()=>{e(u.uz.ADD_SUCCESS,{variant:"success"}),n.invalidateQueries("recruits")},onError:t=>{if(t instanceof r.d7){var n,a;const r=(null===(n=t.response)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.message)||u.uz.ADD_FAIL;e(r,{variant:"error"})}else e(u.uz.UNKNOWN_ERROR,{variant:"error"})}})},v=e=>{const{enqueueSnackbar:t}=(0,s.Ds)(),n=(0,i.cl)()(),o=(0,l.useQuery)(["recruitsByParam",e.toString()],((e,t)=>async()=>(await a.default.get("".concat("https://dev.api.klub.kr","/search/recruits"),{params:e,headers:{Authorization:t}})).data)(e,n),{onError:e=>{e instanceof r.d7||t("\uc11c\ubc84\uc5d0\uc11c \uc624\ub958\uac00 \ubc1c\uc0dd\ud55c \uac83 \uac19\uc544\uc694. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694",{variant:"error"})}});return o},p=e=>{const{enqueueSnackbar:t}=(0,s.Ds)(),n=(0,i.cl)()(),o=(0,l.useQuery)(["recruitList",e],(()=>(async e=>{let{clubId:t,token:n}=e;return(await a.default.get("".concat("https://dev.api.klub.kr","/club/").concat(t,"/recruit/list"),{headers:{Authorization:n}})).data})({clubId:e,token:n})),{onError:e=>{e instanceof r.d7?t(u.uz.LOAD_FAIL,{variant:"error"}):t(u.uz.UNKNOWN_ERROR,{variant:"error"})}});return o},m=(e,t,n)=>{const{enqueueSnackbar:o}=(0,s.Ds)(),c=(0,i.cl)()(),d=(0,l.useQueryClient)();return(0,l.useMutation)((()=>(async e=>{let{clubId:t,token:n,recruitIds:r}=e;r.forEach((async e=>{await a.default.delete("".concat("https://dev.api.klub.kr","/club/").concat(t,"/recruit/").concat(e),{headers:{Authorization:n}})}))})({clubId:e,token:c,recruitIds:t})),{onSuccess:()=>{o(n,{variant:"success"})},onError:e=>{var t,n,a;e instanceof r.d7?o(null!==(t=null===(n=e.response)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.message)&&void 0!==t?t:u.uz.SERVER_ERROR,{variant:"error"}):o(u.uz.UNKNOWN_ERROR,{variant:"error"})},onSettled:()=>{d.invalidateQueries("recruitList")}})},b=(e,t,n)=>{const{enqueueSnackbar:c}=(0,s.Ds)(),d=(0,o.s0)(),h=(0,i.cl)()(),v=(0,l.useQuery)(["recruitExistence",e,t],(()=>(async e=>{let{clubId:t,date:n,token:r}=e;return await a.default.get("".concat("https://dev.api.klub.kr","/club/").concat(t,"/recruit/check?semester=").concat(n.semester,"&year=").concat(n.year),{headers:{Authorization:r}})})({clubId:e,date:t,token:h})),{onSuccess:()=>{c(u.FR.RECRUIT_EXIST_MESSAGE,{variant:"warning"})},onError:t=>{var n;t instanceof r.d7?400===(null===(n=t.response)||void 0===n?void 0:n.status)?d("/manage/".concat(e,"/recruit/register")):c(u.uz.LOAD_FAIL,{variant:"error"}):c(u.uz.UNKNOWN_ERROR,{variant:"error"})},enabled:!!n});return v}}}]);
//# sourceMappingURL=9572.d3eaef25.chunk.js.map